<!DOCTYPE html>
<html>
  <head>
    <title>GPUE</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.40.1" />
<title>Running GPUE :: GPUE</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-blue.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/gpue-group.github.io\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/functionality/running_gpue/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="https://gpue-group.github.io/">GPUE</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/gpue-group/gpue"  rel="noopener">
                  <i class='fa fa-github'></i> <label>GPUE repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/gpue-group/gpue/archive/master.zip"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/development/html/"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>GPUE API</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/intro/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/intro/">Introduction to GPUE</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/intro/gpue_intro/" class="dd-item">
        <div>
          <a href="/intro/gpue_intro/">
            
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/build/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/build/">Building GPUE</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/functionality/" class="dd-item parent alwaysopen haschildren
        ">
      <div>
      <a href="/functionality/">GPUE functionality</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/functionality/running_gpue/" class="dd-item parent active alwaysopen
        ">
      <div>
      <a href="/functionality/running_gpue/">Running GPUE</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/functionality/gauge/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/functionality/gauge/">Gauge Fields</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/functionality/vortex_2d/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/functionality/vortex_2d/">2D Vortex Tracking</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/functionality/dynamic_fields/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/functionality/dynamic_fields/">Dynamic Fields</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/data_analysis/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/data_analysis/">Data analysis</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/data_analysis/output/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/data_analysis/output/">GPUE Output Format</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/data_analysis/python/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/data_analysis/python/">Python Scripts</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/data_analysis/matlab/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/data_analysis/matlab/">Matlab Scripts</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/development/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/development/">Development</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/development/html/" class="dd-item">
        <div>
          <a href="/development/html/">
            
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/intro/" >
   Introduction to GPUE</option> 
      <option value="/intro/gpue_intro/" >- </option>
  
    <option value="/build/" >
   Building GPUE</option> 
  
    <option value="/functionality/" >
   GPUE functionality</option> 
    <option value="/functionality/running_gpue/"  selected>
  - 
   Running GPUE</option> 
  
    <option value="/functionality/gauge/" >
  - 
   Gauge Fields</option> 
  
    <option value="/functionality/vortex_2d/" >
  - 
   2D Vortex Tracking</option> 
  
    <option value="/functionality/dynamic_fields/" >
  - 
   Dynamic Fields</option> 
  
  
    <option value="/data_analysis/" >
   Data analysis</option> 
    <option value="/data_analysis/output/" >
  - 
   GPUE Output Format</option> 
  
    <option value="/data_analysis/python/" >
  - 
   Python Scripts</option> 
  
    <option value="/data_analysis/matlab/" >
  - 
   Matlab Scripts</option> 
  
  
    <option value="/development/" >
   Development</option> 
      <option value="/development/html/" >- </option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/gpue-group.github.io\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Running GPUE</h1>
    
    
    



<ul class="children children-h2">
</ul>

<p>After building GPUE, it is important to run the unit tests with the <code>./gpue -u</code> command and make sure all tests pass.
If they do not, there could be a failure in the building process or a problem with running GPUE on the provided hardware.</p>

<p>After the unit tests have passed, you are free to use GPUE to your heart&rsquo;s content.
The easiest way to run GPUE is by using the provided help menu with the <code>./gpue -h</code> command and creating a command from that; however, a parameter file can also be used for this purpose if it is easier.</p>

<p>This section provides an introduction to the unit tests and a description of the help menu along with some example simulations to run.</p>

<h2 id="unit-tests">Unit tests</h2>

<p>GPUE provides a suite of unit tests for the following operations:</p>

<ol>
<li><em>Math Operator Test:</em> A suite of tests for all in-built mathematical operators</li>
<li><em>Double2 Functions Test:</em> A suite of tests for all in-built operators on CufftDoubleComplex or double2 types</li>
<li><em>Grid Test:</em> This tests to ensures the gpu is functional and simply sends data back and forth to the GPU using a specified number of threads</li>
<li><em>Parallel Summation Test:</em> this tests the parallel summation routine necessary for imaginary-time evolution</li>
<li><em>FFT Test:</em> This is a simple test of the CUFFT library and makes sure that all plans used for FFT operations work</li>
<li><em>Dynamic Test:</em> This is a test of all Abstract Syntax Tree (AST) functions necessary for dynamic fields and potentials.</li>
<li><em>Bessel Test:</em> this is a test of the polynomial approximation to the bessel functions used in the AST data structure</li>
<li><em>Make Complex Test:</em> A test of the <code>make_complex</code> function that turns potentials into operators for evolution</li>
<li><em>cMultPhi_test:</em> Test of the <code>cMultPhi</code> kernel for evolution with an imprinted Phi parameter
10.<em>Evolution Test:</em> Test of imaginary and real0time evolution in 1, 2, and 3 dimensions. This first runs the simulation in imaginary time to ensure the appropriate energy for a single particle in the ground state of an <em>n</em>-dimensional harmonic oscillator and then runs the simulation in real-time to ensure the energy does not vary from this value.</li>
</ol>

<p>These are all done with the <code>./gpue -u</code> command.
Please run this command after building GPUE to test your installation.</p>

<p>The most important of these tests is the Evolution Test.
This one ensures the physical accuracy of the results, so long as the appropriate energy is found in the ground state of the harmonic oscillator, the code should be working as-intended for simple evolution.
If any test fails, please create an issue on <a href="https://github.com/GPUE-group/GPUE">GitHub</a></p>

<h2 id="help-menu">Help menu</h2>

<p>To run GPUE, simply use the <code>./gpue</code> command with appropriate flags for the desired simulation.
To determine which flags should be used, please use the <code>./gpue -h</code> command, which will output the following:</p>

<pre><code>                                      GPUE
          Graphics-Processing Unit Gross--Piteavskii Equation solver
Options:

-A rotation     Set gauge field mode [beta]
-a              Set flag to graph [deprecated]
-b 2.5e-5       Set box size (xyzMax in 3d)
-C 0            Set device (Card) for GPU computing
-c 2            Set coords (1, 2, 3 dimensions)
-D 0.0          Set's offset for kill (-K flag) distance radially
-d data         Set data directory - where to store / read data (here in data/)
-E 0.0001 123   Perform energy calculations, exit groundstate simulations early
                    The calculation frequency defaults to printSteps.
                    Otherwise the threshold and frequency must be given.
-e 1            Set esteps, number of real-time evolution steps
-f              Unset write to file flag
-G 1            Set GammaY, ratio of omega_y to omega_x
-g 1            Set gsteps, number of imaginary-time evolution steps
-H phrase       Print help menu, searching for &quot;phrase&quot;
-h              Print help menu, exit GPUE
-I &quot;param.cfg&quot;  Set Input parameter file
-i 1            Set interaction strength between particles
-j 1            Set threshold multiplier for easier vortex detection
-J              Set cylindrical coordinate output for B-field (no letters)
-K 0            Selects vortex with specified ID to be
                    killed/flipped/mutliply-charged
-k 0            Set kick_it, kicking for Moire lattice simulations
                    0 = off, 1 = periodic kicking, 2 = single kick
-L 0            Set l, vortex winding [2*pi*L]
-l              Set ang_mom flag to use angular momentum
-m              Set 2d_mask for vortex tracking
-N 1            Set N, number of wavefunctions to simulate
-n 1            Set n, number of particles in simulation
-O 0            Set angle_sweep, kicking potential rotation angle
-P 0            Set laser_power, strength of kicking [hbar * omega_perp]
-p 100          Set printSteps, frequency of printing
-Q 0            Set z0_shift, z shift of kicking potential (bad flag, I know)
-q 0            Set the vortex winding for imprinting/annihilation/flipping
                    during real-time. The value is the charge of the new vortex
-R 1            Set ramping flag for imaginary time evolution
                    1 for ramping up, 0 for ramping down
-r              Set read_wfc to continue simulation from file (data/output.h5)
                    All flags will be the same, and only `-g` and `-e` flags can be set
-S 0            Set sepMinEpsilon, kicking potential lattice spacing scaling
-s              Set gpe, flag for using Gross-Pitaevskii Equation
-T 1e-4         Set gdt, timestep for imaginary-time
-t 1e-4         Set dt, timestep for real-time
-U 0            Set x0_shift, x shift of kicking potential, shift of the
                    imprinting vortex position defined by K and q
-u              Performs all unit tests
-V 0            Set y0_shift, y shift of kicking potential, shift of the
                    imprinting vortex position defined by K and q
-v              Set potential [beta]
-W              Set write_it, flag to write to file
-w 0            Set Omega_z, rotation rate relative to omega_perp
                    This acts as a value to multiply the gauge fields by
-X 6.283        Set omega_x
-x 256          Set xDim, dimension in X (power of 2, please!)
-Y 6.283        Set omega_y
-y 256          Set yDim, dimension in Y (power of 2, please!)
-Z 6.283        Set omega_z, confinement in z-dimension
-z 256          Set zDim, dimension in Z (power of 2, please!)

Notes:

- Parameters specified above represent the default values for the classic
  linear Schrodinger equation and may need to be modified to match your
  specific problem.

- We use real units with an Rb87 condensate

- You may generate a simple vortex lattice in 2d with the following command:
  ./gpue -x 512 -y 512 -g 50000 -e 1 -p 5000 -W -w 0.6 -n 1e5 -s -l -Z 100

- Thanks for using GPUE!

</code></pre>

<p>If you would like to search this for a particular flag, please use the <code>./gpue -H search_variable</code> command.
For example, if I wanted to change <code>omega_x</code> I might search for it like so:</p>

<pre><code>./gpue -H omega
</code></pre>

<p>which will provide the following:</p>

<pre><code>-G 1            Set GammaY, ratio of omega_y to omega_x
-P 0            Set laser_power, strength of kicking [hbar * omega_perp]
-w 0            Set Omega_z, rotation rate relative to omega_perp
-X 6.283        Set omega_x
-Y 6.283        Set omega_y
-Z 6.283        Set omega_z, confinement in z-dimension
</code></pre>

<p>This will make it easier to find the flags you might want for the simulation.</p>

<h2 id="special-considerations">Special considerations</h2>

<p>There are several flags that need special consideration here:</p>

<ol>
<li><code>-r</code>: This flag will load and continue a simulation from a file, preserving all parameters specified initially.
If the output file is not in the default location, you will be prompted to enter its path.</li>
<li><code>-A</code>: This flag will read in a gauge field, which can be <code>rotation</code>, <code>constant</code>, or <code>test</code>.</li>
<li><code>-v</code>: This flag is naturally set to be a harmonic oscillator, but can use the <code>torus</code> option in 3D.
Otherwise, the flag&rsquo;s default will be <code>harmonic</code></li>
<li><code>-I</code>: This flag will read in a configuration file for dynamic fields, which will be described later in the documentation</li>
<li><code>-d</code>: This flag will specify a data directory.
All configuration files are expected to be in this directory.
If the directory does not exist at the start of the simulation, GPUE will create the directory.</li>
</ol>

<h2 id="example-simulation">Example simulation</h2>

<p>In addition to the <code>./gpue -u</code> command, the help menu recommends running the following command:</p>

<pre><code>./gpue -x 512 -y 512 -g 50000 -e 1 -p 5000 -W -w 0.6 -n 1e5 -s -l -Z 100
</code></pre>

<p>Here, we will run a slightly modified version of this:</p>

<pre><code>./gpue -x 512 -y 512 -g 50001 -e 1 -p 5000 -W -w 0.6 -n 1e5 -s -l -Z 100 -d data_2d_example
</code></pre>

<p>This will simulate a BEC in imaginary time influenced by a typical angular momentum field and will provide several quantized vortices.
Here are the parameters of this simulation:</p>

<ul>
<li><code>-x 512 -y 512</code>: 512x512 resolution</li>
<li><code>-g 50001</code>: 50001 imaginary time steps. Note that we start counting at 0, so adding the 1 guarantees evolving through the 50000th step</li>
<li><code>-e 1</code>: 1 real time step.</li>
<li><code>-p 5000</code>: printing to terminal every 5000 steps</li>
<li><code>-W</code>: writing to file when printing to terminal</li>
<li><code>-w 0.6</code>: rotational omega value of 0.6 (1 is the maximum)</li>
<li><code>-n 1e5</code>: 100000 atoms</li>
<li><code>-s</code>: using nonlinear Schr&ouml;dinger equation</li>
<li><code>-l</code>: turning on angular momentum (gauge fields)</li>
<li><code>-Z 100</code>: strongly confined in the Z direction with a trapping frequency of 100</li>
<li><code>-d data_2d_example</code>: outputting data into the <code>data_2d_example</code> directory</li>
</ul>

<p>If more ground state evolution timesteps were requested by increasing the value after the <code>-g</code> flag, a triangular vortex lattice can be generated.</p>

<p>The data can be plotted with the <code>plot.py</code> file in the <code>py/</code> directory with the following command:</p>

<pre><code>python plot.py -i wfc -c 0 -r 0 50000 5000 -f ../data_2d_example/output.h5
</code></pre>

<p>Here, we are plotting the first (<code>-c 0</code>) wavefunction (<code>-i wfc</code>) from 0 to 50,000 in steps of 5000 (<code>-r 0 50000 5000</code>) in the <code>data_2d_example</code> directory (<code>-f ../data_2d_example/output.h5</code>).
Note that the <code>-i</code> and <code>-c</code> flags are extraneous here, as they are both set to their default values.</p>

<p>This will provide a series of images that should look something like this:</p>

<p><img src="output.gif" alt="Gif of imaginary time evolution" /></p>







    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/functionality/" title="GPUE functionality"> <i class="fa fa-chevron-left"></i><label>GPUE functionality</label></a>
    <a class="nav nav-next" href="/functionality/gauge/" title="Gauge Fields" style="margin-right: 0px;"><label>Gauge Fields</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

    <div class="github-link">
      <a href="https://github.com/gpue-group/gpue-group.github.iofunctionality/running_GPUE/_index.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>