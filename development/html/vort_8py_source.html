<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GPUE: py/vort.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GPUE
   &#160;<span id="projectnumber">v1.0</span>
   </div>
   <div id="projectbrief">GPU Gross-Pitaevskii Equation numerical solver for Bose-Einstein condensates</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('vort_8py_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">vort.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="vort_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacevort.html">    1</a></span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">import</span> os</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">from</span> numpy <span class="keyword">import</span> genfromtxt</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">import</span> math <span class="keyword">as</span> m</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">import</span> copy <span class="keyword">as</span> cp</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">import</span> ConfigParser</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">import</span> sys</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keywordflow">if</span> (len(sys.argv) == 2):</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespacevort.html#ac33335f0b5b67e4217469271139908c9">   12</a></span>&#160;    data_dir = <span class="stringliteral">&quot;../&quot;</span> + sys.argv[1] + <span class="stringliteral">&quot;/&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keywordflow">else</span>:</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    data_dir = <span class="stringliteral">&quot;&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="namespacevort.html#a4fb1532d7699b80f0771f1bca157a601">   15</a></span>&#160;c = ConfigParser.ConfigParser()</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;c.readfp(open(data_dir + <span class="stringliteral">&#39;Params.dat&#39;</span>, <span class="stringliteral">&quot;r&quot;))</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespacevort.html#ae6337b93e50011704bb83298c350362f">   18</a></span>&#160;<span class="stringliteral">xDim = int(c.getfloat(&#39;Params&#39;</span>,<span class="stringliteral">&#39;xDim&#39;</span>))</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespacevort.html#ad6af20247b9961a90f8c379720adbde9">   19</a></span>&#160;yDim = int(c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;yDim&#39;</span>))</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="namespacevort.html#aa4f78b99f33f16f55665f40933fff507">   20</a></span>&#160;gndMaxVal = int(c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;gsteps&#39;</span>))</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="namespacevort.html#a0f8c72398ec40651fa04f13b1601af15">   21</a></span>&#160;evMaxVal = int(c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;esteps&#39;</span>))</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="namespacevort.html#a73d82e74efd49c6cf1ff50d48ee70a10">   22</a></span>&#160;incr = int(c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;printSteps&#39;</span>))</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="namespacevort.html#ace2207ca7c6fe6e7a316a1fdac965847">   23</a></span>&#160;dx = (c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;dx&#39;</span>))</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="namespacevort.html#a7a08941a849e4dd10704c992b10c6818">   24</a></span>&#160;dt = (c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;dt&#39;</span>))</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespacevort.html#a2f1716e23eacd57fe79daad835320c12">   25</a></span>&#160;xMax = (c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;xMax&#39;</span>))</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespacevort.html#a656f0f2e6da63c7cf683bea2ebe337c0">   26</a></span>&#160;yMax = (c.getfloat(<span class="stringliteral">&#39;Params&#39;</span>,<span class="stringliteral">&#39;yMax&#39;</span>))</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"># quick check to make sure evMax Steps is right. This is simply because of the </span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"># way GPUE outputs data.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keywordflow">if</span> (evMaxVal % incr == 0):</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    evMaxVal = evMaxVal - incr</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classvort_1_1_vortex.html">   34</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvort_1_1_vortex.html">Vortex</a>: <span class="comment">#Tracks indivisual vortices over time.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="namespacevort.html#aa9ad871069bd08f26a6707ad22379e20">   37</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#aa9ad871069bd08f26a6707ad22379e20">__init__</a>(self,uid,x,y,isOn,sign=1):</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    </div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacevort.html#a59249b1e9af3390c94a0500200875327">   39</a></span>&#160;        self.uid = uid</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespacevort.html#a37d7947233d6b72f785082e627f3608c">   40</a></span>&#160;        self.x = x</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespacevort.html#a802f106c639c70f259c4ded87074724e">   41</a></span>&#160;        self.y = y</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespacevort.html#ab82c9df9f496be099c88570404f10f35">   42</a></span>&#160;        self.sign = sign</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespacevort.html#a35e30d26b620c6a27772675b83810b02">   43</a></span>&#160;        self.isOn = isOn</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespacevort.html#a738224df41e356b0edad1fad3daee4c1">   44</a></span>&#160;        self.next = <span class="keywordtype">None</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespacevort.html#a1cea225cc46dc26723104b986e241941">   47</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a1cea225cc46dc26723104b986e241941">update_uid</a>(self,uid):</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        self.uid = uid</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="namespacevort.html#af87273b203aebb62f0fb5f8aa5848f01">   52</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#af87273b203aebb62f0fb5f8aa5848f01">update_on</a>(self,isOn): <span class="comment">#Vortex is trackable</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        self.isOn = isOn</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespacevort.html#a1efb7f4fc7c0040be713c76614b9444d">   57</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a1efb7f4fc7c0040be713c76614b9444d">update_next</a>(self,next): <span class="comment">#Get next vortex</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        self.next = next</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="namespacevort.html#a678d501638156b7acae66aec086841d6">   62</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a678d501638156b7acae66aec086841d6">dist</a>(self,vtx): <span class="comment">#Distance between self and vtx</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="namespacevort.html#ae10a8a98cd2cb630ac04c5dd899d00f1">   64</a></span>&#160;        r = m.sqrt((self.x - vtx.x)**2 + (self.y - vtx.y)**2)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">return</span> r</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classvort_1_1_vtx_list.html">   68</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvort_1_1_vtx_list.html">VtxList</a>: <span class="comment">#Linked-list for tracking vortices</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="namespacevort.html#a27d7bcbc7393babdbec3fe0fb7e0c438">   71</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#aa9ad871069bd08f26a6707ad22379e20">__init__</a>(self):</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespacevort.html#a19fc69a596b09fd02e582adbf8052ccf">   73</a></span>&#160;        self.head = <span class="keywordtype">None</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="namespacevort.html#a1dad4606a81171acb961168ca14deacd">   74</a></span>&#160;        self.tail = <span class="keywordtype">None</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="namespacevort.html#a54df6947679a585530602aafca7a6600">   75</a></span>&#160;        self.length = 0</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="namespacevort.html#a2eaeae7eb94f43c9b73d7219c0206f19">   78</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a2eaeae7eb94f43c9b73d7219c0206f19">element</a>(self,pos): <span class="comment">#Get vtx at position pos</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="namespacevort.html#a44a42936183c9477183f8d9a5d97cabe">   80</a></span>&#160;        pos_l = 0</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">if</span> pos &lt; self.length:</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="namespacevort.html#a32178cb077ec94ed9c655bb3b56e9210">   82</a></span>&#160;            vtx = self.head</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">while</span> pos_l &lt; pos:</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                pos_l = pos_l +1</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                vtx = vtx.next</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">print</span> <span class="stringliteral">&quot;Out of bounds&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            exit(-1)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">return</span> vtx</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespacevort.html#a8a3cdf271a0a6996b62897c2c1c905d1">   92</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a8a3cdf271a0a6996b62897c2c1c905d1">vtx_uid</a>(self,uid): <span class="comment">#Get vtx with identifier uid</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        vtx = self.head</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="namespacevort.html#a0e1e557e9568d9aa2870fabaffbdfc34">   95</a></span>&#160;        pos = 0</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">while</span> vtx.uid != uid:</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            vtx = vtx.next</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            pos = pos +1</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">return</span> [vtx,pos]</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="namespacevort.html#a1b650d0399eed379edb020fdc6ce53bf">  102</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#aac61079cd28178d578b13a093de07939">max_uid</a>(self): <span class="comment">#Return position and value of largest uid</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="namespacevort.html#a09ca066d546b3524e9d2f4bd32679d67">  104</a></span>&#160;        val = 0</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        vtx = self.head</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        val = vtx.uid</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        pos = 0</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">#while pos &lt; self.length:</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">while</span> <span class="keyword">True</span>:</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            vtx = vtx.next</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <a class="code" href="defect_triangulation_8m.html#a45f083d8a2e0a0be8fa69dc162aafa06">if</a>(vtx == <span class="keywordtype">None</span>):</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="keywordflow">break</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">if</span> vtx.uid &gt; val:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                val = vtx.uid</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            pos = pos +1</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">return</span> [val,pos]</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="namespacevort.html#abcca11d0e38e448ceaa0f3f2750f8154">  119</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#abcca11d0e38e448ceaa0f3f2750f8154">add</a>(self,Vtx,index=None): <span class="comment">#Add a vtx at index, otherwise end</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> self.length == 0:</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            self.head = Vtx</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            self.tail = Vtx</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            self.length = 1</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">elif</span> index == <span class="keywordtype">None</span>:</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            self.tail.next = Vtx</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            self.tail = Vtx</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            self.length = self.length +1</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            Vtx.next = self.element(index)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            self.element(index-1).next = Vtx</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            self.length = self.length + 1</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespacevort.html#a147e6272ec8115613cb0d5ac1f48adf7">  135</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a147e6272ec8115613cb0d5ac1f48adf7">as_np</a>(self): <span class="comment">#Return numpy array with format x,y,sign,uid,isOn</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="namespacevort.html#ad5d72055420329f1be67f91127f7b743">  137</a></span>&#160;        dtype = [(<span class="stringliteral">&#39;x&#39;</span>,float),(<span class="stringliteral">&#39;y&#39;</span>,float),(<span class="stringliteral">&#39;sign&#39;</span>,int),(<span class="stringliteral">&#39;uid&#39;</span>,int),(<span class="stringliteral">&#39;isOn&#39;</span>,int)]</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="namespacevort.html#a86cda1987fcf03abee2e73b2981dfa03">  138</a></span>&#160;        data =[]<span class="comment"># np.array([],dtype=dtype)</span></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="namespacevort.html#a418a330f51ebe2e500a6da25a28024c7">  139</a></span>&#160;        i = 0</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        vtx = self.head</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">while</span> vtx != <span class="keywordtype">None</span>:</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            data.append([vtx.x, vtx.y, vtx.sign, vtx.uid, vtx.isOn])</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            vtx = vtx.next</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            i = i+1</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">return</span> (data)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="namespacevort.html#ae67366df2a115701d019952f54ef6c88">  148</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#ae67366df2a115701d019952f54ef6c88">write_out</a>(self,time,data): <span class="comment">#Write out CSV file as  x,y,sign,uid,isOn</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="namespacevort.html#aac861bf31a93e2574d51ba3f007f9be4">  150</a></span>&#160;        np.savetxt(data_dir+<span class="stringliteral">&#39;vort_ord_&#39;</span>+str(time)+<span class="stringliteral">&#39;.csv&#39;</span>,data,fmt=<span class="stringliteral">&#39;%10.5f,%10.5f,%i,%i,%i&#39;</span>,delimiter=<span class="stringliteral">&#39;,&#39;</span>)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="namespacevort.html#ad3f1591dc21b7d9371dcf4f0e7789938">  153</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#ad3f1591dc21b7d9371dcf4f0e7789938">idx_min_dist</a>(self,vortex, isSelf=False): <span class="comment">#Closest vtx to self</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="namespacevort.html#aea8a83badb8cd32d0b974a438f0d6aaf">  155</a></span>&#160;        counter = 0</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="namespacevort.html#a61b959de15b41fe6524c477449d491fa">  156</a></span>&#160;        ret_idx = counter</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        vtx = self.head</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> vtx != <span class="keywordtype">None</span>:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            r = vtx.dist(vortex)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">while</span> vtx.next != <span class="keywordtype">None</span>:</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                vtx = vtx.next</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                counter = counter +1</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">if</span> r &gt; vtx.dist(vortex):</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    r = vtx.dist(vortex)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    ret_idx = counter</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">return</span> (ret_idx,r)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="namespacevort.html#a0cf326457a849e9c931a951e272125a8">  169</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a0cf326457a849e9c931a951e272125a8">remove</a>(self,pos): <span class="comment">#Remove vortices outside artificial boundary</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span> self.length &gt; 1 <span class="keywordflow">and</span> pos &gt; 1:</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="namespacevort.html#a31e72c1ec40a1d590350de09c091c7bc">  172</a></span>&#160;            current = self.element(pos-1).next</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            self.element(pos - 1).next = current.next</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            current.next = <span class="keywordtype">None</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            self.length = self.length - 1</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">return</span> current</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">elif</span> pos == 0:</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            current = self.head</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            self.head = self.head.next</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            self.length = self.length - 1</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">return</span> current</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            self.head = <span class="keywordtype">None</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            self.length = 0</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="namespacevort.html#a2c1fd4179e7f01c2b988a8cfc04d403b">  188</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a2c1fd4179e7f01c2b988a8cfc04d403b">swap_uid</a>(self,uid_i,uid_f): <span class="comment">#Swap uid between vtx</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="namespacevort.html#abcc4099f44db63540daa66433d072924">  190</a></span>&#160;        vtx_pos = self.vtx_uid(uid_i)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        self.remove(pos_i)</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="namespacevort.html#aaec1e74db145f3a0d8773bb4cdfebf09">  192</a></span>&#160;        self.add(vtx,index=pos_f)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="namespacevort.html#abf14927d090dd130439b2ebfaac5423b">  195</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#abf14927d090dd130439b2ebfaac5423b">vort_decrease</a>(self,positions,vorts_p): <span class="comment">#Turn off vortex timeline</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">for</span> i4 <span class="keywordflow">in</span> positions:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">#print positions, &quot;Decrease&quot;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            vtx = cp.copy(i4)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            vtx.update_on(<span class="keyword">False</span>)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            vtx.update_next(<span class="keywordtype">None</span>) </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            self.add(vtx)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="namespacevort.html#a16850a60f391a2d4ee0ea82a5355b6a5">  205</a></span>&#160;    <span class="keyword">def </span><a class="code" href="namespacevort.html#a16850a60f391a2d4ee0ea82a5355b6a5">vort_increase</a>(self,positions,vorts_p): <span class="comment">#Add new vtx to tracking</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        counter = 1</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="namespacevort.html#aac61079cd28178d578b13a093de07939">  208</a></span>&#160;        max_uid = vorts_p.max_uid()</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">for</span> i4 <span class="keywordflow">in</span> positions:</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">#print positions, &quot;Increase&quot;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            self.element(i4).<a class="code" href="namespacevort.html#a1cea225cc46dc26723104b986e241941">update_uid</a>(max_uid[0] + counter)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            counter = counter+1</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="namespacevort.html#a3d9176f380246129be8a11c6c69840a6">  215</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacevort.html#a3d9176f380246129be8a11c6c69840a6">run</a>(start,fin,incr): <span class="comment">#Performs the tracking</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="namespacevort.html#a5f517e5ade03a8aee641ad0fda96ffbf">  217</a></span>&#160;    v_arr_p=genfromtxt(data_dir+<span class="stringliteral">&#39;vort_arr_&#39;</span> + str(incr),delimiter=<span class="stringliteral">&#39;,&#39;</span>)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range( start + incr*2, fin + 1, incr): <span class="comment">#loop over samples in time</span></div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="namespacevort.html#a525bd4da35965171b1fa9b4f1dcb82d8">  219</a></span>&#160;        vorts_p = <a class="code" href="classvort_1_1_vtx_list.html">VtxList</a>()</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="namespacevort.html#a58700bf9f790b144219d3180574d3698">  220</a></span>&#160;        vorts_c = <a class="code" href="classvort_1_1_vtx_list.html">VtxList</a>()</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="namespacevort.html#a47366997e81fb25bf2a4459bd4f4be1b">  221</a></span>&#160;        v_arr_c=genfromtxt(data_dir+<span class="stringliteral">&#39;vort_arr_&#39;</span> + str(i), delimiter=<span class="stringliteral">&#39;,&#39;</span>)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> i==start + incr*2:</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="comment">#from IPython import embed; embed()</span></div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="namespacevort.html#a9c6502e23b261faef82b5a4a2dd2ba6c">  224</a></span>&#160;            v_arr_p_coords = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_p[:,[1,3]]]) <span class="comment"># Select the coordinates from the previous timestep</span></div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="namespacevort.html#aee095dc657a5b912a424faf262630bd9">  225</a></span>&#160;            v_arr_c_coords = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_c[:,[1,3]]]) <span class="comment"># Select the coordinates from the current timestep</span></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="namespacevort.html#a64dcd7d845eab0ce76c7cf17ab5440a6">  226</a></span>&#160;            v_arr_p_sign = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_p[:,4]]) <span class="comment"># Select the vortex signs from previous</span></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="namespacevort.html#a74dc67f778c2e312bbe8a4c6418ad5c0">  227</a></span>&#160;            v_arr_c_sign = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_c[:,4]]) <span class="comment"># Select the vortex signs from current</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            v_arr_p_coords = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_p[:,[0,1]]]) <span class="comment">#Previous coords</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            v_arr_p_sign = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_p[:,2]]) <span class="comment">#Previous sign</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        v_arr_c_coords = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_c[:,[1,3]]]) <span class="comment">#Current coords</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        v_arr_c_sign = np.array([a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> v_arr_c[:,4]]) <span class="comment">#Current sign</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">for</span> i1 <span class="keywordflow">in</span> range(0,v_arr_p_coords.size/2): <span class="comment">#loop over previous coordinates for a given time</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="namespacevort.html#a4e8284daf67054d5540b107f0c8f1b3f">  235</a></span>&#160;            vtx_p = <a class="code" href="classvort_1_1_vortex.html">Vortex</a>(i1,v_arr_p_coords[i1][0],v_arr_p_coords[i1][1],<span class="keyword">True</span>,sign=v_arr_p_sign[i1]) <span class="comment"># Create a vortex object with uid given by number i1</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            vorts_p.add(vtx_p)<span class="comment">#Add vortex to the list</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">for</span> i2 <span class="keywordflow">in</span> range(0,v_arr_c_coords.size/2): <span class="comment">#loop over current coordinates for a given time</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="namespacevort.html#aab33cc86db7a91cf9cdd71c5135f208d">  239</a></span>&#160;            vtx_c = <a class="code" href="classvort_1_1_vortex.html">Vortex</a>(-1-i2,v_arr_c_coords[i2][0],v_arr_c_coords[i2][1],<span class="keyword">True</span>,sign=v_arr_c_sign[i2]) <span class="comment"># Create a vortex object with uid -1 - i2</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            vorts_c.add(vtx_c) <span class="comment">#Add vortex object to list</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">for</span> i3 <span class="keywordflow">in</span> range(0,vorts_p.length): <span class="comment"># For all previous vortices in list</span></div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="namespacevort.html#a39ca6bbf4b91af143f9ed6cab7e5d3d0">  243</a></span>&#160;            index_r = vorts_c.idx_min_dist(vorts_p.element(i3)) <span class="comment"># Find the smallest distance vortex index between current and previous data</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="namespacevort.html#a42b50a0463be3e131ce4cdeef4ec047e">  245</a></span>&#160;            v0c = vorts_c.element(index_r[0]).sign <span class="comment">#Get the sign of the smallest distance vortex</span></div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="namespacevort.html#ac2ee1d4d9f3b4b9d37d04a0e5d3dc2a5">  246</a></span>&#160;            v0p = vorts_p.element(i3).sign <span class="comment"># Get the sign of the current vortex at index i3</span></div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="namespacevort.html#a7998f8a9479496a672b52939de63d26a">  247</a></span>&#160;            v1c = vorts_c.element(index_r[0]).uid <span class="comment">#Get uid of current vortex</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                        <span class="comment">#Check if distance is less than 7 grid points, and that the sign is matched between previous and current vortices, and that the current vortex has a negative uid, indicating that a pair has not yet been found. If true, then update the current vortex index to that of the previous vortex index, and turn vortex on --- may be dangerous</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">if</span> (index_r[1] &lt; 30) <span class="keywordflow">and</span> (vorts_c.element(index_r[0]).sign == vorts_p.element(i3).sign) <span class="keywordflow">and</span> (vorts_c.element(index_r[0]).uid &lt; 0) <span class="keywordflow">and</span> (vorts_p.element(i3).isOn == <span class="keyword">True</span>):</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                vorts_c.element(index_r[0]).<a class="code" href="namespacevort.html#a1cea225cc46dc26723104b986e241941">update_uid</a>(vorts_p.element(i3).uid)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                vorts_c.element(index_r[0]).<a class="code" href="namespacevort.html#af87273b203aebb62f0fb5f8aa5848f01">update_on</a>(<span class="keyword">True</span>)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">print</span> <span class="stringliteral">&quot;Failed to find any matching vortex. Entering interactive mode. Exit with Ctrl+D&quot;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keyword">from</span> IPython <span class="keyword">import</span> embed; embed()</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">#You will never remember why this works</span></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="namespacevort.html#acbf727735f7cc007a049e254766f7e39">  258</a></span>&#160;        uid_c = [[a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> b][3] <span class="keywordflow">for</span> b <span class="keywordflow">in</span> vorts_c.as_np()] <span class="comment"># Slice the uids for current data</span></div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="namespacevort.html#a3ecba3af22e8090d6e6a51955b66dff5">  259</a></span>&#160;        uid_p = [[a <span class="keywordflow">for</span> a <span class="keywordflow">in</span> b][3] <span class="keywordflow">for</span> b <span class="keywordflow">in</span> vorts_p.as_np()] <span class="comment"># Slice uids for previous data</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">#Check the difference between current and previous vtx data</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="namespacevort.html#a93a79fa3f3bedc21b67ceb07ae3bc857">  261</a></span>&#160;        dpc = <a class="code" href="defect_triangulation_8m.html#af46fc1931bfde620ebb6de9e92437148">set</a>(uid_p).difference(<a class="code" href="defect_triangulation_8m.html#af46fc1931bfde620ebb6de9e92437148">set</a>(uid_c)) <span class="comment"># Creates a set and checks the elements for differences. Namely, finds which uids are unique to previous (ie which ones are no longer in current due to annihilation or falling outside boundary), which uids are only in current (ie newly found vortices, or older vortices that have reappeared)</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="namespacevort.html#a17bac6858600088581a626dc42b647de">  262</a></span>&#160;        dcp = <a class="code" href="defect_triangulation_8m.html#af46fc1931bfde620ebb6de9e92437148">set</a>(uid_c).difference(<a class="code" href="defect_triangulation_8m.html#af46fc1931bfde620ebb6de9e92437148">set</a>(uid_p))</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="namespacevort.html#a6568ef666004671f2bf84dac9aced133">  263</a></span>&#160;        vtx_pos_p=[]</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="namespacevort.html#a73bc1c614ec11f93fdbfedbdbdcc9430">  264</a></span>&#160;        vtx_pos_c=[]</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">#For all elements in the set of previous to current, note [vtx, pos] vtx for previous, and pos for current</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">for</span> i5 <span class="keywordflow">in</span> dpc:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            vtx_pos_p = np.append(vtx_pos_p,vorts_p.vtx_uid(i5)[0]) <span class="comment">#vtx</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">for</span> i6 <span class="keywordflow">in</span> dcp:</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            vtx_pos_c = np.append(vtx_pos_c,vorts_c.vtx_uid(i6)[1]) <span class="comment">#pos</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> len(dpc <span class="keywordflow">or</span> dcp) &gt;= 1: <span class="comment">#if any differences were found, call the below functions</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            vorts_c.vort_decrease(vtx_pos_p,vorts_p)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            vorts_c.vort_increase(vtx_pos_c,vorts_p)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="comment"># Sort the vortices in current based on uid value, and write out the data</span></div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="namespacevort.html#ae54ed9dbc742e76b86f3a47c60d36f07">  275</a></span>&#160;        vorts_c_update=sorted(vorts_c.as_np(),key=<span class="keyword">lambda</span> vtx: vtx[3])</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        vorts_c.write_out(i,np.asarray(vorts_c_update))</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">print</span> <span class="stringliteral">&quot;[&quot;</span> + str(i) +<span class="stringliteral">&quot;]&quot;</span>, <span class="stringliteral">&quot;Length of previous=&quot;</span> + str(len(v_arr_p_coords)), <span class="stringliteral">&quot;Length of current=&quot;</span> + str(len(vorts_c_update))</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        v_arr_p=genfromtxt(data_dir+<span class="stringliteral">&#39;vort_ord_&#39;</span> + str(i) + <span class="stringliteral">&#39;.csv&#39;</span>,delimiter=<span class="stringliteral">&#39;,&#39;</span> )</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<a class="code" href="namespacevort.html#a3d9176f380246129be8a11c6c69840a6">run</a>(0, evMaxVal, incr)</div><div class="ttc" id="defect_triangulation_8m_html_a45f083d8a2e0a0be8fa69dc162aafa06"><div class="ttname"><a href="defect_triangulation_8m.html#a45f083d8a2e0a0be8fa69dc162aafa06">if</a></div><div class="ttdeci">end if(length(DT.vertexAttachments{ii})==5) if plotit plot(x(ii)</div></div>
<div class="ttc" id="namespacevort_html_abf14927d090dd130439b2ebfaac5423b"><div class="ttname"><a href="namespacevort.html#abf14927d090dd130439b2ebfaac5423b">vort.vort_decrease</a></div><div class="ttdeci">def vort_decrease(self, positions, vorts_p)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00195">vort.py:195</a></div></div>
<div class="ttc" id="namespacevort_html_ae67366df2a115701d019952f54ef6c88"><div class="ttname"><a href="namespacevort.html#ae67366df2a115701d019952f54ef6c88">vort.write_out</a></div><div class="ttdeci">def write_out(self, time, data)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00148">vort.py:148</a></div></div>
<div class="ttc" id="namespacevort_html_a0cf326457a849e9c931a951e272125a8"><div class="ttname"><a href="namespacevort.html#a0cf326457a849e9c931a951e272125a8">vort.remove</a></div><div class="ttdeci">def remove(self, pos)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00169">vort.py:169</a></div></div>
<div class="ttc" id="namespacevort_html_abcca11d0e38e448ceaa0f3f2750f8154"><div class="ttname"><a href="namespacevort.html#abcca11d0e38e448ceaa0f3f2750f8154">vort.add</a></div><div class="ttdeci">def add(self, Vtx, index=None)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00119">vort.py:119</a></div></div>
<div class="ttc" id="namespacevort_html_a1cea225cc46dc26723104b986e241941"><div class="ttname"><a href="namespacevort.html#a1cea225cc46dc26723104b986e241941">vort.update_uid</a></div><div class="ttdeci">def update_uid(self, uid)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00047">vort.py:47</a></div></div>
<div class="ttc" id="namespacevort_html_a678d501638156b7acae66aec086841d6"><div class="ttname"><a href="namespacevort.html#a678d501638156b7acae66aec086841d6">vort.dist</a></div><div class="ttdeci">def dist(self, vtx)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00062">vort.py:62</a></div></div>
<div class="ttc" id="defect_triangulation_8m_html_af46fc1931bfde620ebb6de9e92437148"><div class="ttname"><a href="defect_triangulation_8m.html#af46fc1931bfde620ebb6de9e92437148">set</a></div><div class="ttdeci">% set(gca, 'Color', [0 0 0])</div></div>
<div class="ttc" id="namespacevort_html_af87273b203aebb62f0fb5f8aa5848f01"><div class="ttname"><a href="namespacevort.html#af87273b203aebb62f0fb5f8aa5848f01">vort.update_on</a></div><div class="ttdeci">def update_on(self, isOn)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00052">vort.py:52</a></div></div>
<div class="ttc" id="namespacevort_html_aa9ad871069bd08f26a6707ad22379e20"><div class="ttname"><a href="namespacevort.html#aa9ad871069bd08f26a6707ad22379e20">vort.__init__</a></div><div class="ttdeci">def __init__(self, uid, x, y, isOn, sign=1)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00037">vort.py:37</a></div></div>
<div class="ttc" id="namespacevort_html_a147e6272ec8115613cb0d5ac1f48adf7"><div class="ttname"><a href="namespacevort.html#a147e6272ec8115613cb0d5ac1f48adf7">vort.as_np</a></div><div class="ttdeci">def as_np(self)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00135">vort.py:135</a></div></div>
<div class="ttc" id="namespacevort_html_a8a3cdf271a0a6996b62897c2c1c905d1"><div class="ttname"><a href="namespacevort.html#a8a3cdf271a0a6996b62897c2c1c905d1">vort.vtx_uid</a></div><div class="ttdeci">def vtx_uid(self, uid)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00092">vort.py:92</a></div></div>
<div class="ttc" id="classvort_1_1_vtx_list_html"><div class="ttname"><a href="classvort_1_1_vtx_list.html">vort.VtxList</a></div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00068">vort.py:68</a></div></div>
<div class="ttc" id="namespacevort_html_a16850a60f391a2d4ee0ea82a5355b6a5"><div class="ttname"><a href="namespacevort.html#a16850a60f391a2d4ee0ea82a5355b6a5">vort.vort_increase</a></div><div class="ttdeci">def vort_increase(self, positions, vorts_p)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00205">vort.py:205</a></div></div>
<div class="ttc" id="namespacevort_html_a1efb7f4fc7c0040be713c76614b9444d"><div class="ttname"><a href="namespacevort.html#a1efb7f4fc7c0040be713c76614b9444d">vort.update_next</a></div><div class="ttdeci">def update_next(self, next)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00057">vort.py:57</a></div></div>
<div class="ttc" id="namespacevort_html_aac61079cd28178d578b13a093de07939"><div class="ttname"><a href="namespacevort.html#aac61079cd28178d578b13a093de07939">vort.max_uid</a></div><div class="ttdeci">def max_uid</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00208">vort.py:208</a></div></div>
<div class="ttc" id="namespacevort_html_a2c1fd4179e7f01c2b988a8cfc04d403b"><div class="ttname"><a href="namespacevort.html#a2c1fd4179e7f01c2b988a8cfc04d403b">vort.swap_uid</a></div><div class="ttdeci">def swap_uid(self, uid_i, uid_f)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00188">vort.py:188</a></div></div>
<div class="ttc" id="namespacevort_html_a3d9176f380246129be8a11c6c69840a6"><div class="ttname"><a href="namespacevort.html#a3d9176f380246129be8a11c6c69840a6">vort.run</a></div><div class="ttdeci">def run(start, fin, incr)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00215">vort.py:215</a></div></div>
<div class="ttc" id="namespacevort_html_a2eaeae7eb94f43c9b73d7219c0206f19"><div class="ttname"><a href="namespacevort.html#a2eaeae7eb94f43c9b73d7219c0206f19">vort.element</a></div><div class="ttdeci">def element(self, pos)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00078">vort.py:78</a></div></div>
<div class="ttc" id="classvort_1_1_vortex_html"><div class="ttname"><a href="classvort_1_1_vortex.html">vort.Vortex</a></div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00034">vort.py:34</a></div></div>
<div class="ttc" id="namespacevort_html_ad3f1591dc21b7d9371dcf4f0e7789938"><div class="ttname"><a href="namespacevort.html#ad3f1591dc21b7d9371dcf4f0e7789938">vort.idx_min_dist</a></div><div class="ttdeci">def idx_min_dist(self, vortex, isSelf=False)</div><div class="ttdef"><b>Definition:</b> <a href="vort_8py_source.html#l00153">vort.py:153</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_15fe2cec17dffb22c04117b383426cd3.html">py</a></li><li class="navelem"><a class="el" href="vort_8py.html">vort.py</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
